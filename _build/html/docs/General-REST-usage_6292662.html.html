

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>eZ Publish Platform 5.&lt;next&gt; : General REST usage &mdash; Doc eZ Publish 2014 1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Doc eZ Publish 2014 1.0 documentation" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="../index.html">Doc eZ Publish 2014 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <ol class="arabic simple">
<li><a class="reference external" href="index.html">eZ Publish Platform 5.&lt;next&gt;</a></li>
<li><a class="reference external" href="eZ-Publish-Platform-Documentation_1114149.html">eZ Publish Platform
Documentation</a></li>
<li><a class="reference external" href="6291674.html">Development &amp; Administration Guides</a></li>
<li><a class="reference external" href="eZ-Publish-REST-API_6292277.html">eZ Publish REST API</a></li>
</ol>
<div class="section" id="ez-publish-platform-5-next-general-rest-usage">
<h1>eZ Publish Platform 5.&lt;next&gt; : General REST usage<a class="headerlink" href="#ez-publish-platform-5-next-general-rest-usage" title="Permalink to this headline">¶</a></h1>
<p>Added by <a class="reference external" href="mailto:bertrand&#46;dunogier&#37;&#52;&#48;ez&#46;no">bertrand<span>&#46;</span>dunogier<span>&#64;</span>ez<span>&#46;</span>no</a> , edited by <a class="reference external" href="mailto:gaetano&#46;giunta&#37;&#52;&#48;ez&#46;no">gaetano<span>&#46;</span>giunta<span>&#64;</span>ez<span>&#46;</span>no</a> on Jul
20, 2013</p>
<p>As explained in the <a class="reference external" href="eZ-Publish-REST-API_6292277.html">introduction</a>,
the REST API is based on a very limited list of general principles:</p>
<ul class="simple">
<li>each resource (uri) interacts with a part of the system (Content, URL
aliases, user groups...),</li>
<li>for each resource, one or more verbs are available, each having a
different effect (delete a Content, get a URL Alias, list user
groups...),</li>
<li>media-type request headers indicate what type of data (Content /
ContentInfo), and data format (JSON or XML), are expected as a
response, and what can be requested.</li>
</ul>
<div class="section" id="anatomy-of-a-rest-call">
<h2>Anatomy of a REST call<a class="headerlink" href="#anatomy-of-a-rest-call" title="Permalink to this headline">¶</a></h2>
<div class="section" id="what-we-can-learn-from-a-get-request">
<h3>What we can learn from a GET request<a class="headerlink" href="#what-we-can-learn-from-a-get-request" title="Permalink to this headline">¶</a></h3>
<p>This verb is used to query the API for information. It is one of the two
operations web browsers implement, and the most commonly used.</p>
<div class="section" id="request">
<h4>Request<a class="headerlink" href="#request" title="Permalink to this headline">¶</a></h4>
<p>The only requirement for this verb is usually the resource URI, and the
accept header. On top of that, cache request headers can be added, like
<tt class="docutils literal"><span class="pre">If-None-Match</span></tt>, but those aren&#8217;t fully implemented yet in eZ Publish
5.0.</p>
<p><strong>Load ContentInfo request</strong></p>
</div>
<div class="section" id="response-headers">
<h4>Response headers<a class="headerlink" href="#response-headers" title="Permalink to this headline">¶</a></h4>
<p>The API will reply with:</p>
<ul class="simple">
<li>an&nbsp;<strong>HTTP response code</strong>,</li>
<li>a few <strong>headers</strong>,</li>
<li>the XML representation of the ContentInfo for content with ID 23 in
XML format, as specified in the Accept header.</li>
</ul>
<p><strong>Load ContentInfo response</strong></p>
<p>The length of our content, provided by the Content-Length header,
isn&#8217;t&nbsp;<em>that</em> useful.</p>
<div class="section" id="http-code">
<h5>HTTP Code<a class="headerlink" href="#http-code" title="Permalink to this headline">¶</a></h5>
<p>The API responded here with a standard 200 OK HTTP response code, which
is the expected response code for a &#8220;normal&#8221; GET request. Some GET
requests, like&nbsp;<a class="reference external" href="https://github.com/ezsystems/ezpublish-kernel/blob/master/doc/specifications/rest/REST-API-V2.rst#13241%C2%A0%C2%A0%C2%A0get-current-version">getting a content&#8217;s current
version</a>,
may reply with a 301 Moved permanently, or 307 Temporary redirect code.</p>
<p>Errors will be indicated with HTTP error codes, like 404 for Not Found,
or 500 for Internal server error. The <a class="reference external" href="https://github.com/ezsystems/ezpublish-kernel/blob/master/doc/specifications/rest/REST-API-V2.rst">REST
specifications</a>
provide the list of every HTTP response code you can expect from
implemented resources.</p>
</div>
<div class="section" id="content-type-header">
<h5>Content-Type header<a class="headerlink" href="#content-type-header" title="Permalink to this headline">¶</a></h5>
<p>As long as a response contains an actual HTTP body, the Content-Type
header will be used to specify which Content-Type is contained in the
response. In that case, a&nbsp;ContentInfo
(<tt class="docutils literal"><span class="pre">Content-Type:</span> <span class="pre">application/vnd.ez.api.ContentInfo</span></tt>) in XML
(<tt class="docutils literal"><span class="pre">Content-Type:&nbsp;application/vnd.ez.api.ContentInfo+xml</span></tt>)</p>
</div>
<div class="section" id="accept-patch-header">
<h5>Accept-Patch header<a class="headerlink" href="#accept-patch-header" title="Permalink to this headline">¶</a></h5>
<p>This is a very interesting one.</p>
<p>It tells us we can modify the received content by patching
(<tt class="docutils literal"><span class="pre">Accept-Patch:</span> <span class="pre">application/vnd.ez.api.ContentUpdate+xml;charset=utf8</span></tt>)
it with a
<a class="reference external" href="https://github.com/ezsystems/ezpublish-kernel/blob/master/eZ/Publish/API/Repository/Values/Content/ContentUpdateStruct.php">ContentUpdateStruct</a>
(<tt class="docutils literal"><span class="pre">Accept-Patch:</span> <span class="pre">application/vnd.ez.api.ContentUpdate+xml;charset=utf8</span></tt>)&nbsp;in
XML&nbsp;&nbsp;(<tt class="docutils literal"><span class="pre">Accept-Patch:</span> <span class="pre">application/vnd.ez.api.ContentUpdate+xml;charset=utf8</span></tt>)
format. Of course, JSON would also work, with the proper format.</p>
<p>This last part means that if we send a PATCH /content/objects/23 request
with a
<a class="reference external" href="https://github.com/ezsystems/ezpublish-kernel/blob/master/eZ/Publish/API/Repository/Values/Content/ContentUpdateStruct.php">ContentUpdateStruct</a>&nbsp;XML
payload, we will update this Content.</p>
<p>Icon</p>
<p>REST will use the <tt class="docutils literal"><span class="pre">Accept-Patch</span></tt> header to indicate you how to
<strong>modify</strong>the returned<strong>data</strong>.</p>
</div>
<div class="section" id="other-headers-location">
<h5>Other headers: Location<a class="headerlink" href="#other-headers-location" title="Permalink to this headline">¶</a></h5>
<p>Depending on the resource, request &amp; response headers will vary. For
instance,&nbsp;<a class="reference external" href="https://github.com/ezsystems/ezpublish-kernel/blob/master/doc/specifications/rest/REST-API-V2.rst#13231%C2%A0%C2%A0%C2%A0creating-content">creating
content</a>,
or <a class="reference external" href="https://github.com/ezsystems/ezpublish-kernel/blob/master/doc/specifications/rest/REST-API-V2.rst#13241%C2%A0%C2%A0%C2%A0get-current-version">getting a content&#8217;s current
version</a>&nbsp;will
both send a <tt class="docutils literal"><span class="pre">Location</span></tt> header to provide you with the requested
resource&#8217;s ID.</p>
<p>Those particular headers generally match a specific list of HTTP
response codes. Location is sent by <tt class="docutils literal"><span class="pre">201</span> <span class="pre">Created</span></tt>,
<tt class="docutils literal"><span class="pre">301</span> <span class="pre">Moved</span> <span class="pre">permanently,</span></tt> <tt class="docutils literal"><span class="pre">307</span> <span class="pre">Temporary</span> <span class="pre">redirect</span> <span class="pre">responses</span></tt>. This
list isn&#8217;t finished, but you can expect those HTTP responses to provide
you with a Location header.</p>
</div>
<div class="section" id="other-headers-destination">
<h5>Other headers: Destination<a class="headerlink" href="#other-headers-destination" title="Permalink to this headline">¶</a></h5>
<p>This request header is the request counterpart of the Location response
header. It is used in a COPY / MOVE operation, like <a class="reference external" href="https://github.com/ezsystems/ezpublish-kernel/blob/master/doc/specifications/rest/REST-API-V2.rst#13236%C2%A0%C2%A0%C2%A0copy-content">copying a
Content</a>,
on a resource to indicate where the resource should be moved to, using
the ID of the destination.</p>
</div>
</div>
<div class="section" id="response-body">
<h4>Response body<a class="headerlink" href="#response-body" title="Permalink to this headline">¶</a></h4>
<p><strong>Load ContentInfo response body</strong> &nbsp;Expand source</p>
<p>The XML body is a serialized version of a
<a class="reference external" href="https://github.com/ezsystems/ezpublish-kernel/blob/master/eZ/Publish/API/Repository/Values/Content/ContentInfo.php">ContentInfo</a>
struct. Most REST API calls will actually involve exchanging XML / JSON
representations of the public API. This consistency, which we took very
seriously, was a hard requirement for us, as it makes documentation much
better by requiring&nbsp;<em>less</em> of it.</p>
<p>As explained above, the API has told us that we could modify content
object 23 by sending a <tt class="docutils literal"><span class="pre">vendor/application/vnd.ez.ContentUpdate+xml</span></tt>.
This media type again matches a Value in the API,
<a class="reference external" href="https://github.com/ezsystems/ezpublish-kernel/blob/master/eZ/Publish/API/Repository/Values/Content/ContentUpdateStruct.php">ContentUpdateStruct</a>.</p>
<p>Icon</p>
<p>The REST API data structs mostly match a PHP Public API value object</p>
</div>
<div class="section" id="value-objects-representation">
<h4>Value objects representation<a class="headerlink" href="#value-objects-representation" title="Permalink to this headline">¶</a></h4>
<p>Value objects like
<a class="reference external" href="https://github.com/ezsystems/ezp-next/blob/master/eZ/Publish/API/Repository/Values/Content/ContentInfo.php">ContentInfo</a>&nbsp;basically
feature two types of fields: basic, local fields (modified, name...) and
foreign field(s) references (sectionId, mainLocationId).</p>
<p>Local fields will be represented in XML / JSON with a primitive type
(integer, string), while foreign key references will be represented as a
link to another resource. This resource will be identified with its URI
(<tt class="docutils literal"><span class="pre">/content/objects/23/locations</span></tt>), and the media-type that should be
requested when calling that resource
(<tt class="docutils literal"><span class="pre">media-type=&quot;application/vnd.ez.api.LocationList+xml&quot;</span></tt>). Depending on
how much data you need, you may choose to crawl those relations, or to
ignore them.</p>
<p>XSD files</p>
<p>Icon</p>
<p>For each XML structure known to the REST API, you can find XSD files in
the XSD folder of the specifications. Those will allow you to validate
your XML, and learn about every option those XML structures feature.</p>
<p><a class="reference external" href="https://github.com/ezsystems/ezpublish-kernel/tree/master/doc/specifications/rest/xsd">https://github.com/ezsystems/ezpublish-kernel/tree/master/doc/specifications/rest/xsd</a></p>
</div>
</div>
</div>
<div class="section" id="request-parameters">
<h2>Request parameters<a class="headerlink" href="#request-parameters" title="Permalink to this headline">¶</a></h2>
<p>So far, we have seen that responses will depend on:</p>
<ul class="simple">
<li>The URI,</li>
<li>Request headers, like the Accept one</li>
</ul>
<p>URI parameters are of course also used. They usually serve as filters /
options for the requested resource. For instance, they can be used to
customize a list&#8217;s offset/limit, to filter a list, specify which fields
you want from a content...&nbsp;For almost all resources, those parameters
must be provided as GET ones. This request would return the 5 first
relations for Version 2 of Content 59:</p>
<p><strong>GET request with limit parameter</strong></p>
</div>
<div class="section" id="custom-http-verbs">
<h2>Custom HTTP verbs<a class="headerlink" href="#custom-http-verbs" title="Permalink to this headline">¶</a></h2>
<p>In addition to the usual GET, POST, PUT and DELETE HTTP verbs, the API
supports a few custom ones: COPY, MOVE
(<a class="reference external" href="http://tools.ietf.org/html/rfc2518">http://tools.ietf.org/html/rfc2518</a>),
PATCH
(<a class="reference external" href="http://tools.ietf.org/html/rfc5789">http://tools.ietf.org/html/rfc5789</a>)&nbsp;and
PUBLISH. While it should generally not be a problem, some HTTP servers
may fail to recognize those. If you face this situation, you can
customize a standard verb (POST, PUT) with
the&nbsp;<tt class="docutils literal"><span class="pre">X-HTTP-Method-Override</span></tt> header.</p>
<p><strong>PATCH HTTP request</strong></p>
<p>Both methods are always mentioned, when applicable, in the
specifications.</p>
</div>
<div class="section" id="specifying-a-siteaccess">
<h2>Specifying a siteaccess<a class="headerlink" href="#specifying-a-siteaccess" title="Permalink to this headline">¶</a></h2>
<p>One of the principles of REST is that the same resource (Content,
Location, ContentType, ...) should be unique. The purpose is mostly to
make it simple to cache your REST API using a reverse proxy like
Varnish. If the same resource is available at multiple locations, cache
purging becomes much more complex.</p>
<p>Due to this, we decided not to enable siteaccess matching with REST. In
order to specify a siteaccess when talking to the REST API, a custom
header,&nbsp;<tt class="docutils literal"><span class="pre">X-Siteaccess</span></tt>, needs to be provided. If it isn&#8217;t, the
default one will be used:</p>
<p><strong>X-Siteaccess header example</strong></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Document generated by Confluence on Feb 12, 2014 16:43</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">eZ Publish Platform 5.&lt;next&gt; : General REST usage</a><ul>
<li><a class="reference internal" href="#anatomy-of-a-rest-call">Anatomy of a REST call</a><ul>
<li><a class="reference internal" href="#what-we-can-learn-from-a-get-request">What we can learn from a GET request</a><ul>
<li><a class="reference internal" href="#request">Request</a></li>
<li><a class="reference internal" href="#response-headers">Response headers</a><ul>
<li><a class="reference internal" href="#http-code">HTTP Code</a></li>
<li><a class="reference internal" href="#content-type-header">Content-Type header</a></li>
<li><a class="reference internal" href="#accept-patch-header">Accept-Patch header</a></li>
<li><a class="reference internal" href="#other-headers-location">Other headers: Location</a></li>
<li><a class="reference internal" href="#other-headers-destination">Other headers: Destination</a></li>
</ul>
</li>
<li><a class="reference internal" href="#response-body">Response body</a></li>
<li><a class="reference internal" href="#value-objects-representation">Value objects representation</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#request-parameters">Request parameters</a></li>
<li><a class="reference internal" href="#custom-http-verbs">Custom HTTP verbs</a></li>
<li><a class="reference internal" href="#specifying-a-siteaccess">Specifying a siteaccess</a></li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/docs/General-REST-usage_6292662.html.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li><a href="../index.html">Doc eZ Publish 2014 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, eZ Systems.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>